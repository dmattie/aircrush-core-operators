BootStrap: library
From: ubuntu:18.04


%files
    scripts /usr/local

%environment
    export LC_ALL=C
    export PATH=/usr/local:/usr/local/scripts:$PATH    


%post
    
    apt-get update && apt-get install -y netcat
    NOW=`date`
    echo "export NOW=\"${NOW}\"" >> $SINGULARITY_ENVIRONMENT

    apt-get install -y software-properties-common
    add-apt-repository universe

    apt-get install -y wget
    apt-get install -y unzip
    apt-get install -y rsync
    apt-get install -y tar     
    apt-get install -y python3
    apt-get install -y python3-pip
    apt-get install -y git
    pip3 install -i https://test.pypi.org/simple/ aircrushcore
    pip3 install requests
    pip3 install setuptools
    pip3 install asyncssh
    pip3 install requests-toolbelt
    pip3 install iniconfig

    git clone https://github.com/dmattie/aircrush-core-operators.git /opt/aircrush
    
%runscript    
    echo "Arguments received: first: $1    all:$*"
    python3 /opt/aircrush/start.py $*


%labels
    Author dmattie
